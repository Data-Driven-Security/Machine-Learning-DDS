---
title: "Reporte "
author: "Silvia Bolaños, Geraldine Lopez"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(randomForest)
library(readr)
library(caret)
library(e1071)

# selected_cols <- c("SrcBytes", "DstBytes", "Land", "WrongFragment", "Urgent", "SameSrvRate", "LoggedIn",  "DstHostSameSrvRate", "DstHostSrvCount","Flag","Attack" )
selected_cols <- c("SrcBytes", "DstBytes", "WrongFragment", "Urgent", "SameSrvRate", "LoggedIn",  "DstHostSameSrvRate", "DstHostSrvCount","Flag","Attack" )


```
  


```{r read_data}
data_full <- read_csv("../data/Book1.csv",
                  col_types = cols(SrcBytes = col_integer(),
                                   DstBytes = col_integer(), Land = col_integer(),
                                   WrongFragment = col_integer(), Urgent = col_number(),
                                   Hot = col_number(), NumFailedLogin = col_integer()))

data <- read.csv (file="../data/Book2.csv",header=T)

```

## Introducción
Para iniciar el proceso de análisis de la data de KDD Cup 1999, debemos entender en qué consiste esta base de datos. El conjunto de datos de KDD Cup 1999, un conjunto de datos de referencia en el campo de la detección de intrusos en la red, que presenta una oportunidad única para analizar y comprender los patrones de tráfico de la red. Este conjunto de datos captura información de conexión de red, incluidos varios atributos, como direcciones IP de origen y destino, tipos de protocolo y duración de la conexión. El objetivo principal de analizar este conjunto de datos es detectar y clasificar las intrusiones en la red con precisión.


## Objetivo
En este análisis, nuestro objetivo es explorar el conjunto de datos de la Copa KDD de 1999 y obtener información sobre los comportamientos del tráfico de red. Mediante el empleo de técnicas de análisis de datos exploratorios, examinaremos la estructura, las distribuciones y las relaciones entre los atributos del conjunto de datos. Profundizaremos en la distribución de clases para comprender la prevalencia de las conexiones normales frente a las intrusiones, y analizaremos las características de los diferentes tipos de conexión de red. Además, aplicaremos algoritmos de aprendizaje automático para construir modelos de clasificación capaces de predecir con precisión las intrusiones en la red en función de los atributos disponibles. Este análisis proporcionará información valiosa sobre la naturaleza del tráfico de la red, ayudará a identificar posibles amenazas de seguridad y contribuirá al desarrollo de sistemas de detección de intrusos eficaces. 

##  1. Comprender el conjunto de datos:

El primer paso para iniciar el análisis es entender en qué consisten los datos proporcionados. En el extracto de Book2.csv podemos encontrar las siguientes columnas con su respectiva definición en los anexos. Con estas definiciones podemos comprender el conjunto de datos, su estructura y el contenido. 

## 2.	Análisis exploratorio de datos: 
El segundo paso es la visualización de datos, crearemos visualizaciones como histogramas, diagramas de caja, diagramas de dispersión o matrices de correlación para comprender la distribución, las relaciones y los posibles valores atípicos en los datos. Utilizaremos el paquete llamado “DataExplorer” para ayudarnos en realizar un reporte sobre la información.


## Including Plots

You can also embed plots, for example:

```{r feature_selection, echo=FALSE}
data1 <- data[,selected_cols]
# data1 <- data[,c(4:12)]
data1$Attack <- as.factor(data1$Attack)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r train_test, echo=FALSE}
inTrain <- createDataPartition(y=data1$Attack,p=0.01, list=FALSE)
str (data1)
training <- data1[inTrain,]
testing <- data1[-inTrain,]
dim <-nrow (training)
dim(training)
```


```{r train_random_forest, echo=FALSE}
output.forest <- randomForest(Attack ~ ., data = training)
print(output.forest)
plot(output.forest)
```


```{r predict, echo=FALSE}
pred <- predict(output.forest,testing)
str (pred)

```

```{r simple_validation, echo=FALSE}
valid <- testing
valid$Attack <- as.character(valid$Attack)
valid$pred <- as.character(pred)
valid$match <- valid$Attack == valid$pred

table(valid$match)/nrow(valid)*100
```

```{r simple_validation2, echo=FALSE}
table(valid[, c("match", "Attack")])
```

```{r conf_matrix, echo=FALSE}
valid <- testing
cm <- confusionMatrix(pred, testing$Attack)
kableExtra::kable(cm$table)
```

```{r conf_matrix_heatmap, echo=FALSE}
heatmap(cm$table)
```
